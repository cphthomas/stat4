<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Kvantitative metoder for de finansielle uddannelser.</title>
  <meta name="description" content="Kvantitative metoder.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Kvantitative metoder for de finansielle uddannelser." />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Kvantitative metoder." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kvantitative metoder for de finansielle uddannelser." />
  
  <meta name="twitter:description" content="Kvantitative metoder." />
  

<meta name="author" content="Thomas Petersen">


<meta name="date" content="2018-09-30">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="prev" href="cran-r.html">
<link rel="next" href="kvantitative-metoder.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistik</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="1" data-path="sandsynligheder.html"><a href="sandsynligheder.html"><i class="fa fa-check"></i><b>1</b> Sandsynligheder</a><ul>
<li class="chapter" data-level="1.0.1" data-path="sandsynligheder.html"><a href="sandsynligheder.html#forenings--og-flleshndelser"><i class="fa fa-check"></i><b>1.0.1</b> Forenings- og fælleshændelser</a></li>
<li class="chapter" data-level="1.1" data-path="sandsynligheder.html"><a href="sandsynligheder.html#betingede-sandsynligheder"><i class="fa fa-check"></i><b>1.1</b> Betingede sandsynligheder</a><ul>
<li class="chapter" data-level="1.1.1" data-path="sandsynligheder.html"><a href="sandsynligheder.html#race-og-ddsdom-eksempel"><i class="fa fa-check"></i><b>1.1.1</b> Race og dødsdom eksempel</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="sandsynligheder.html"><a href="sandsynligheder.html#uafhngighed"><i class="fa fa-check"></i><b>1.2</b> Uafhængighed</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html"><i class="fa fa-check"></i><b>2</b> Chi i anden tests</a><ul>
<li class="chapter" data-level="2.1" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html#goodness-of-fit-test"><i class="fa fa-check"></i><b>2.1</b> Goodness of fit test</a></li>
<li class="chapter" data-level="2.2" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html#forudstning"><i class="fa fa-check"></i><b>2.2</b> Forudsætning</a></li>
<li class="chapter" data-level="2.3" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html#chi-i-anden-test"><i class="fa fa-check"></i><b>2.3</b> Chi i anden test</a><ul>
<li class="chapter" data-level="2.3.1" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html#uafhngighed-1"><i class="fa fa-check"></i><b>2.3.1</b> Uafhængighed</a></li>
<li class="chapter" data-level="2.3.2" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html#anmeldte-skader-fordelt-pa-regioner-og-antal-skader"><i class="fa fa-check"></i><b>2.3.2</b> Anmeldte skader fordelt på regioner og antal skader</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html#selvtest"><i class="fa fa-check"></i><b>2.4</b> Selvtest</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>3</b> ANOVA</a><ul>
<li class="chapter" data-level="3.1" data-path="anova.html"><a href="anova.html#selvtest-1"><i class="fa fa-check"></i><b>3.1</b> Selvtest</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cran-r.html"><a href="cran-r.html"><i class="fa fa-check"></i><b>4</b> Cran R</a><ul>
<li class="chapter" data-level="4.1" data-path="cran-r.html"><a href="cran-r.html#r-video-tutorials"><i class="fa fa-check"></i><b>4.1</b> R video-tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="faktoranalyse.html"><a href="faktoranalyse.html"><i class="fa fa-check"></i><b>5</b> Faktoranalyse</a><ul>
<li class="chapter" data-level="5.1" data-path="faktoranalyse.html"><a href="faktoranalyse.html#hvilke-faktorer-er-vigtige-nar-man-kber-en-ny-computer"><i class="fa fa-check"></i><b>5.1</b> Hvilke faktorer er vigtige når man køber en ny computer:</a></li>
<li class="chapter" data-level="5.2" data-path="faktoranalyse.html"><a href="faktoranalyse.html#forudstninger-for-faktoranalysen."><i class="fa fa-check"></i><b>5.2</b> Forudsætninger for faktoranalysen.</a></li>
<li class="chapter" data-level="5.3" data-path="faktoranalyse.html"><a href="faktoranalyse.html#selve-faktoranalysen"><i class="fa fa-check"></i><b>5.3</b> Selve Faktoranalysen</a></li>
<li class="chapter" data-level="5.4" data-path="faktoranalyse.html"><a href="faktoranalyse.html#hvor-mange-faktorer-br-benyttes"><i class="fa fa-check"></i><b>5.4</b> Hvor mange faktorer bør benyttes?</a><ul>
<li class="chapter" data-level="5.4.1" data-path="faktoranalyse.html"><a href="faktoranalyse.html#eigenvalues-metoden"><i class="fa fa-check"></i><b>5.4.1</b> Eigenvalues metoden</a></li>
<li class="chapter" data-level="5.4.2" data-path="faktoranalyse.html"><a href="faktoranalyse.html#screeplot-metoden"><i class="fa fa-check"></i><b>5.4.2</b> Screeplot metoden</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="faktoranalyse.html"><a href="faktoranalyse.html#hierakisk-klyngeanalyse-hclust-kommandoen"><i class="fa fa-check"></i><b>5.5</b> Hierakisk klyngeanalyse hclust kommandoen</a></li>
<li class="chapter" data-level="5.6" data-path="faktoranalyse.html"><a href="faktoranalyse.html#ikke-hierakisk-klyngeanalyse-kmeans-kommandoen"><i class="fa fa-check"></i><b>5.6</b> Ikke hierakisk klyngeanalyse kmeans kommandoen</a></li>
<li class="chapter" data-level="5.7" data-path="faktoranalyse.html"><a href="faktoranalyse.html#validering-med-anova"><i class="fa fa-check"></i><b>5.7</b> Validering med ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="kvantitative-metoder.html"><a href="kvantitative-metoder.html"><i class="fa fa-check"></i><b>6</b> Kvantitative metoder</a></li>
<li class="chapter" data-level="7" data-path="arima000.html"><a href="arima000.html"><i class="fa fa-check"></i><b>7</b> ARIMA(0,0,0)</a></li>
<li class="chapter" data-level="8" data-path="arima100-eller-ar1-autoregression.html"><a href="arima100-eller-ar1-autoregression.html"><i class="fa fa-check"></i><b>8</b> ARIMA(1,0,0) eller AR(1) autoregression</a></li>
<li class="chapter" data-level="9" data-path="arima010-eller-i1-random-walk-with-a-drift.html"><a href="arima010-eller-i1-random-walk-with-a-drift.html"><i class="fa fa-check"></i><b>9</b> ARIMA(0,1,0) eller I(1) Random Walk with a drift</a></li>
<li class="chapter" data-level="10" data-path="arima001-eller-ma1-moving-average.html"><a href="arima001-eller-ma1-moving-average.html"><i class="fa fa-check"></i><b>10</b> ARIMA(0,0,1) eller MA(1) Moving average</a></li>
<li class="chapter" data-level="11" data-path="plots-med-forskellige-modeller.html"><a href="plots-med-forskellige-modeller.html"><i class="fa fa-check"></i><b>11</b> Plots med forskellige modeller</a></li>
<li class="chapter" data-level="12" data-path="arima-og-ssonalitet.html"><a href="arima-og-ssonalitet.html"><i class="fa fa-check"></i><b>12</b> ARIMA og sæsonalitet</a><ul>
<li class="chapter" data-level="12.1" data-path="arima-og-ssonalitet.html"><a href="arima-og-ssonalitet.html#traktorer"><i class="fa fa-check"></i><b>12.1</b> Traktorer</a></li>
<li class="chapter" data-level="12.2" data-path="arima-og-ssonalitet.html"><a href="arima-og-ssonalitet.html#detail-debet-card-forbrug-pa-island-millioner-isk."><i class="fa fa-check"></i><b>12.2</b> Detail debet card forbrug på Island (millioner ISK).</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="forecast-aktiekurser.html"><a href="forecast-aktiekurser.html"><i class="fa fa-check"></i><b>13</b> Forecast Aktiekurser</a></li>
<li class="divider"></li>
<li><a href="https://tepedu.com" target="blank">Thomas Petersen</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Kvantitative metoder for de finansielle uddannelser.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="faktoranalyse" class="section level1">
<h1><span class="header-section-number">Kapitel 5</span> Faktoranalyse</h1>
<style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style>
<div class="embed-container">
<iframe src="https://player.vimeo.com/video/292365661" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen>
</iframe>
</div>
<p><br></p>
<p>Faktoranalyse FA er ligesom, klyngeanalyse vi ser på senere, en strukturanalyse, der belyser hvilke sammenhænge der er i et datasæt. FA er en statistikmodel der navnlig bruges til at forenkle tolkningen af et datamateriale, der indeholder en stor mængde variable. FA bygger på et kæmpe antal udregninger med udgangspunkt i korrelationskoefficienter og er i praksis nærmest umulig at gennemføre uden brug af computersoftware. Før computerens opfindelse kunne en faktoranalyse nemt lægge beslag på en halv snes statistikere på fuld tid gennem flere måneder. Resultatet ville være identifikation få faktorer, skjult i et datamateriale.</p>
<p>Faktoranalysen kan fx. hjælpe med at vise sammenhænge mellem svar i spørgeskemaer, hvilket kan være en hjælp markedsføringsmæssigt, til at forstå hvilke svar samvarierer. En sådan gruppering af spørgsmål kan hjælpe med bedre at forstå kundernes ønsker og behov. Faktoranalyse FA er et godt værktøj til at forstå, hvad dine spørgeskemadata betyder, især når du har mange variable. Faktoranalysen forsøger at finde skjulte variable, som forklarer opførslen af dine observerede variable. FA har historiske rødder i psykometri, dvs målingen af mentale egenskaber.</p>
<p>I modsætning hertil søger man med Klyngeanalysen at finde sammenhænge mellem respondenterne/observationerne og altså ikke variablene, hvilket er et godt hjælpeværktøj i forbindelse med markedssegmentering.</p>
<p>Der findes 2 typer af FA Exploratory Factor Analysis (EFA) og Confirmatory Factor Analysis (CFA). EFA betyder, at du ikke rigtig ved, hvilke skjulte variable (eller faktorer) der findes, og hvor mange de er, så du forsøger at finde dem. CFA betyder, at du allerede har nogle gæt eller modeller på skjulte variable (eller faktorer), og vi vil kontrollere, om dette er korrekt. Vi benytter i det følgende EFA</p>
<div id="hvilke-faktorer-er-vigtige-nar-man-kber-en-ny-computer" class="section level2">
<h2><span class="header-section-number">5.1</span> Hvilke faktorer er vigtige når man køber en ny computer:</h2>
<style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style>
<div class="embed-container">
<iframe src="https://player.vimeo.com/video/292365603" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen>
</iframe>
</div>
<p><br></p>
<p>Lad os sige, man har indsamlet et spørgeskema for at undersøge, hvad der er vigtigt, når en forbruger bestemmer, hvilken computer der skal købes. Spørgeskemaet er udformet, som hvor vigtig er Pris for computerkøbet, vægt fra 1 til 7 hvor 7 er højest/vigtigst.</p>
<p>Dette datasæt er lille i forhold til, hvad der er realistisk, da vi blot forsøger at illustrere analysen. Normalt vil man have flere end 6 variable. For at sikre solid analyseresultater vil man have flere respondenter/observationer.</p>
<p>I noterne er input til R og output fra R, markeret i grå rammer. Output dvs. resultaterne R leverer er markeret med ## i hver linje. Input dvs. de kommandoer vi skal skrive ind i R er ikke markeret.</p>
<p>Rammen herunder er input til R, da linjerne ikke er markeret. Læs datasættet ind i R, dette kan du gøre ved at copy paste nedenstående kode, i den grå ramme, direkte ind i R enten i console eller et script.</p>
<p>Bemærk data.frame er en to-dimensionel data struktur, nedenstående betyder vore 6 variable nu er lagret i en dataframe.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">Pris &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">Software &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">Æstetik &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">7</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">Brand &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">7</span>)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">Venner &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">Familie &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1-8" data-line-number="8">data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Pris, Software, Æstetik, Brand, Venner, Familie)</a></code></pre></div>
</div>
<div id="forudstninger-for-faktoranalysen." class="section level2">
<h2><span class="header-section-number">5.2</span> Forudsætninger for faktoranalysen.</h2>
<style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style>
<div class="embed-container">
<iframe src="https://player.vimeo.com/video/292365022" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen>
</iframe>
</div>
<p><br></p>
<p>Nu skal vi undersøge om det er fornuftigt at foretage en faktoranalyse, dette kan vi undersøge ved enten Bartletts korrelationstest eller Kaiser-Meyer-Olkin KMO.</p>
<p>For at teste dette skal man installere og loade pakken psych, vi skal kun installere første gang. Bemærk install.packages(“psych”) er kommenteret ud nedenfor, så første gang skal du kommentere install.packages(“psych”) ud.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">#install.packages(&quot;psych&quot;)</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">library</span>(<span class="st">&quot;psych&quot;</span>)</a></code></pre></div>
<p>Du kan alternativt benytte pacman pakken, hvilket ofte er at foretrække. Hvis du indlæser nedenstående installeres og loades pakken psych:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;pacman&quot;</span>)) <span class="kw">install.packages</span>(<span class="st">&quot;pacman&quot;</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">pacman<span class="op">::</span><span class="kw">p_load</span>(psych)</a></code></pre></div>
<p>Nu hvor psych pakken er indlæst kan vi køre bartlett test i R:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">cortest.bartlett</span>(data)</a></code></pre></div>
<pre><code>## $chisq
## [1] 36.15696
## 
## $p.value
## [1] 0.00167791
## 
## $df
## [1] 15</code></pre>
<p>Nulhypotesen i Bartletts test er at variablene ikke er korrelerede dvs. alle korrelationskoefficienter <span class="math inline">\(\rho=0\)</span>,</p>
<p><span class="math display">\[H_0:Alle\ \rho=0\]</span>
<span class="math display">\[H_1:Ikke\ alle\ \rho=0  \]</span></p>
<p>Forkaster vi nulhypotesen, er der basis for at gennemføre faktoranalysen. Den lille p-værdi på 0.00167791, betyder vi gennemfører faktoranalysen.</p>
<p>Vi kan ligeledes køre Kaiser-Meyer-Olkin KMO testet fra pshych pakken:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">KMO</span>(data)</a></code></pre></div>
<pre><code>## Kaiser-Meyer-Olkin factor adequacy
## Call: KMO(r = data)
## Overall MSA =  0.49
## MSA for each item = 
##     Pris Software  Æstetik    Brand   Venner  Familie 
##     0.71     0.70     0.57     0.49     0.30     0.37</code></pre>
<p>For KMO skal Overall MSA = 0.49, fortæller om egnethed af data til faktoranalyse. Skal være større end kritisk grænse på ca. 0.5, dette er ikke helt tilfældet her, men vi gennemfører alligevel faktoranalysen.</p>
<p>Vi kan se af korrelationsmatricen, at nogle variable er korrellerede og andre tilsyneladende ikke.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">cor</span>(data)</a></code></pre></div>
<pre><code>##                 Pris   Software     Æstetik       Brand     Venner
## Pris      1.00000000  0.1856123 -0.63202219 -0.58026680 0.03082006
## Software  0.18561230  1.0000000 -0.14621516 -0.11858645 0.10096774
## Æstetik  -0.63202219 -0.1462152  1.00000000  0.85285436 0.03989799
## Brand    -0.58026680 -0.1185864  0.85285436  1.00000000 0.33316719
## Venner    0.03082006  0.1009677  0.03989799  0.33316719 1.00000000
## Familie  -0.06183118  0.1765724 -0.06977360  0.02662389 0.60727189
##              Familie
## Pris     -0.06183118
## Software  0.17657236
## Æstetik  -0.06977360
## Brand     0.02662389
## Venner    0.60727189
## Familie   1.00000000</code></pre>
<p>Så det ser ud til, at Pris har stærke negative sammenhænge med Æstetik og Brand.<br />
Venner har en stærk positiv sammenhæng med Familie.</p>
<p>Det betyder, at vi kan forvente, at vi vil have to fælles faktorer, og en vil være relateret til pris, æstetik og brand, og den anden vil være relateret til ven og familie. Vi kan lave et corrplot, der grafisk illustrerer disse sammenhænge, store blå prikker er positiv korrelation, store røde negativ korrelation. Så vi skal installere corplott pakken, her bruger vi pacman til installationen.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">pacman<span class="op">::</span><span class="kw">p_load</span>(corrplot)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">corrplot</span>(<span class="kw">cor</span>(data), <span class="dt">order =</span> <span class="st">&quot;hclust&quot;</span>, <span class="dt">tl.col=</span><span class="st">&#39;black&#39;</span>, <span class="dt">tl.cex=</span>.<span class="dv">5</span>) </a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/corrplot-1.svg" width="672" /></p>
</div>
<div id="selve-faktoranalysen" class="section level2">
<h2><span class="header-section-number">5.3</span> Selve Faktoranalysen</h2>
<style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style>
<div class="embed-container">
<iframe src="https://player.vimeo.com/video/292365273" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen>
</iframe>
</div>
<p><br></p>
<p>Vi er nu klar til at teste om der er grundlag for at sammenlægge variable til faktorer. Dette tester vi i selve faktor analysen, ved hjælp af funktionen factanal.</p>
<p>Hvis vi samler alle spørgsmål til en samlet faktor, har vi følgende faktor analyse:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">fa1 &lt;-<span class="st"> </span><span class="kw">factanal</span>(data, <span class="dt">factor=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">fa1</a></code></pre></div>
<pre><code>## 
## Call:
## factanal(x = data, factors = 1)
## 
## Uniquenesses:
##     Pris Software  Æstetik    Brand   Venner  Familie 
##    0.567    0.977    0.126    0.167    0.974    1.000 
## 
## Loadings:
##          Factor1
## Pris     -0.658 
## Software -0.152 
## Æstetik   0.935 
## Brand     0.912 
## Venner    0.161 
## Familie         
## 
##                Factor1
## SS loadings      2.190
## Proportion Var   0.365
## 
## Test of the hypothesis that 1 factor is sufficient.
## The chi square statistic is 12.79 on 9 degrees of freedom.
## The p-value is 0.172</code></pre>
<p><strong>Uniqueness</strong> angiver hvor meget af variationen i en variabel, der ikke er associeret med faktoren. Jo lavere Uniqueness, des større sammenhæng til faktorerne.</p>
<p><strong>Loadings</strong> angiver hvordan hver variabel er vægtet for faktorerne, men også hvor stærk korrelationen er til hver faktor. Faktor 1 påvirkes således mest af Æstetik, Brand og Pris. Denne faktor kan ses af corrplottet hvor disse tre variable ses at påvirke hinanden, Pris er negativt korreleret med Æstetik og Brand.</p>
<p><strong>Proportion Var</strong> er et vigtigt nøgletal, der angiver andelen af variationen i data, der er forklaret af den pågældende faktor. Her forklares alså kun 36.5% af variationen i datasættet. Proportion Var findes som SS loadings divideret med antallet af variable dvs. her 6.</p>
<p>Lad os se på hvad der sker, hvis vi deler variablene op i 2 faktorer:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">fa2 &lt;-<span class="st"> </span><span class="kw">factanal</span>(data, <span class="dt">factor=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">fa2</a></code></pre></div>
<pre><code>## 
## Call:
## factanal(x = data, factors = 2)
## 
## Uniquenesses:
##     Pris Software  Æstetik    Brand   Venner  Familie 
##    0.559    0.960    0.126    0.080    0.005    0.609 
## 
## Loadings:
##          Factor1 Factor2
## Pris     -0.657         
## Software -0.161   0.119 
## Æstetik   0.933         
## Brand     0.928   0.242 
## Venner    0.100   0.992 
## Familie           0.620 
## 
##                Factor1 Factor2
## SS loadings      2.207   1.453
## Proportion Var   0.368   0.242
## Cumulative Var   0.368   0.610
## 
## Test of the hypothesis that 2 factors are sufficient.
## The chi square statistic is 2.16 on 4 degrees of freedom.
## The p-value is 0.706</code></pre>
<p><strong>Cumulative Var</strong> 0.61 er summen af proportion var 0.368 og 0.242, og betyder at faktor 1 og faktor 2 forklarer 61% af variationen i datamaterialet.</p>
<p>Faktor 2 forklares altså primært af Venner og Familie, dette stemmer godt overens med billedet vi så i corrplot.</p>
<p>Nu opdeler vi variablene i 3 faktorer.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">fa3 &lt;-<span class="st"> </span><span class="kw">factanal</span>(data, <span class="dt">factor=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">fa3</a></code></pre></div>
<pre><code>## 
## Call:
## factanal(x = data, factors = 3)
## 
## Uniquenesses:
##     Pris Software  Æstetik    Brand   Venner  Familie 
##    0.468    0.944    0.154    0.005    0.193    0.005 
## 
## Loadings:
##          Factor1 Factor2 Factor3
## Pris     -0.717           0.122 
## Software -0.146   0.172         
## Æstetik   0.908  -0.130         
## Brand     0.892  -0.116   0.430 
## Venner            0.440   0.781 
## Familie           0.970   0.228 
## 
##                Factor1 Factor2 Factor3
## SS loadings      2.161   1.198   0.872
## Proportion Var   0.360   0.200   0.145
## Cumulative Var   0.360   0.560   0.705
## 
## The degrees of freedom for the model is 0 and the fit was 0.0188</code></pre>
<p>Nu forklares 70.5% af variationen i datamaterialet altså ud fra de 3 faktorer.</p>
</div>
<div id="hvor-mange-faktorer-br-benyttes" class="section level2">
<h2><span class="header-section-number">5.4</span> Hvor mange faktorer bør benyttes?</h2>
<style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style>
<div class="embed-container">
<iframe src="https://player.vimeo.com/video/292365468" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen>
</iframe>
</div>
<p><br></p>
<p>Der er ingen fast regel for hvor mange faktorer der bør benyttes. Der er flere forskelle metoder til bestemmelse af antallet af faktorer, vi viser herunder 2 metoder.</p>
<div id="eigenvalues-metoden" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Eigenvalues metoden</h3>
<p>Eigenvalues udtrykker hvor meget af datamaterialets samlede varians, der dækkes af den pågældende faktor. Eigenvalues er standardiserede således at summen giver antallet af variable, herunder ses at summen er 6, da der er 6 variable i datasættet. Vi ser hvor stor en del af variationen hver faktor forklarer, når der er 6 faktorer. Faktor 5 og faktor 6 bibringer meget lidt yderligere forklaring af variationen.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">ev &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cor</span>(data))</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">ev<span class="op">$</span>values</a></code></pre></div>
<pre><code>## [1] 2.45701130 1.68900056 0.89157047 0.60583326 0.27285334 0.08373107</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">sum</span>(ev<span class="op">$</span>values)</a></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">ev<span class="op">$</span>values<span class="op">/</span><span class="kw">sum</span>(ev<span class="op">$</span>values)</a></code></pre></div>
<pre><code>## [1] 0.40950188 0.28150009 0.14859508 0.10097221 0.04547556 0.01395518</code></pre>
<p>Når vi benytter Eigenvalues metoden, bestemmes antallet af faktorer ud fra antallet af Eigenvalues større end 1, det er denne metode fx. SPSS benytter. Vi ser at kun 2 Eigenvalues er 2.45701130 og 1.68900056 er større end 1, vi får således kun 2 faktorer. Eigenvalues metoden er ofte lidt konservativ, således at vi får færre faktorer end med de øvrige metoder.</p>
</div>
<div id="screeplot-metoden" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Screeplot metoden</h3>
<p>Vi kan se på nedenstående screeplot, der hvor kurven flader ud, bibringer yderligere faktorer ikke synderlig megen yderligere forklaring til modellen. Man vil med screeplot kriteriet, vælge antallet af faktorer hvor kurven knækkker i tilfældet med 3 faktorer. Man vil ikke altid entydigt kunne afgøre hvor screeplot kurven knækker, her må man så afgøre dette bedst muligt.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">screeplot</span>(<span class="kw">princomp</span>(data),<span class="dt">type=</span><span class="st">&quot;line&quot;</span>,<span class="dt">npcs =</span> <span class="dv">6</span>, <span class="dt">main=</span><span class="st">&quot;Screeplot Computereksempel&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-14-1.svg" width="672" /></p>
<br>
<details>
<p><summary>Spørgsmål personality Stanford</summary>
Hent nu filen personality, hvor 240 Stanford studerende har svaret på i hvor høj grad de mener at besidde 32 forskellige personlighedstræk. 1 til 8 hvor 1 er mindst og 8 er mest. Foretag hvis en test viser dette er fordelagtigt en faktoranalyse.</p>
<p>Download personality fra filen <a href="personality.xlsx" download>her</a> og importer den i R via File - Import Dataset.</p>
</details>
<br>
<details>
<p><summary>Svar personality Stanford</summary></p>
<style>.embed-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; } .embed-container iframe, .embed-container object, .embed-container embed { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }</style>
<div class="embed-container">
<iframe src="https://player.vimeo.com/video/292364790" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen>
</iframe>
</div>
<p><br></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">pacman<span class="op">::</span><span class="kw">p_load</span>(psych)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="kw">cortest.bartlett</span>(personality)</a></code></pre></div>
<pre><code>## R was not square, finding R from data</code></pre>
<pre><code>## $chisq
## [1] 4009.545
## 
## $p.value
## [1] 0
## 
## $df
## [1] 496</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">KMO</span>(personality)</a></code></pre></div>
<pre><code>## Kaiser-Meyer-Olkin factor adequacy
## Call: KMO(r = personality)
## Overall MSA =  0.84
## MSA for each item = 
## distant talkatv carelss hardwrk anxious agreebl   tense    kind opposng 
##    0.88    0.86    0.82    0.87    0.82    0.73    0.84    0.81    0.79 
## relaxed disorgn outgoin approvn     shy discipl   harsh persevr friendl 
##    0.86    0.75    0.87    0.89    0.87    0.84    0.85    0.86    0.87 
## worryin respnsi contrar sociabl    lazy coopera   quiet organiz criticl 
##    0.81    0.86    0.83    0.90    0.89    0.83    0.87    0.78    0.87 
##     lax laidbck withdrw givinup easygon 
##    0.81    0.73    0.90    0.89    0.78</code></pre>
<p>Vi gennemfører klart analysen viser begge tests.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co">#cor(personality) korrelationsmatricen er udeladt af pladshensyn.</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="kw">corrplot</span>(<span class="kw">cor</span>(personality), <span class="dt">order =</span> <span class="st">&quot;hclust&quot;</span>, <span class="dt">tl.col=</span><span class="st">&#39;black&#39;</span>, <span class="dt">tl.cex=</span>.<span class="dv">5</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-17-1.svg" width="672" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">screeplot</span>(<span class="kw">princomp</span>(personality),<span class="dt">type=</span><span class="st">&quot;line&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Screeplot personality&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-18-1.svg" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">evp &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cor</span>(personality))</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">evp<span class="op">$</span>values</a></code></pre></div>
<pre><code>##  [1] 7.2407068 4.5250901 3.1240573 2.3335890 1.8783611 1.1940636 0.9268636
##  [8] 0.8553802 0.7968460 0.7128793 0.6936229 0.6396893 0.6277046 0.5399600
## [15] 0.5074253 0.4719721 0.4639916 0.4455816 0.4376430 0.4135706 0.3906941
## [22] 0.3696839 0.3273829 0.3014077 0.2940833 0.2800131 0.2522101 0.2349649
## [29] 0.2199461 0.2011492 0.1658493 0.1336176</code></pre>
<p>Vi benytter her 7 faktorer:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1">fapers7 &lt;-<span class="st"> </span><span class="kw">factanal</span>(personality,<span class="dv">7</span>)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2">fapers7</a></code></pre></div>
<pre><code>## 
## Call:
## factanal(x = personality, factors = 7)
## 
## Uniquenesses:
## distant talkatv carelss hardwrk anxious agreebl   tense    kind opposng 
##   0.529   0.377   0.491   0.416   0.347   0.576   0.273   0.416   0.512 
## relaxed disorgn outgoin approvn     shy discipl   harsh persevr friendl 
##   0.390   0.181   0.251   0.640   0.387   0.478   0.517   0.560   0.377 
## worryin respnsi contrar sociabl    lazy coopera   quiet organiz criticl 
##   0.388   0.411   0.392   0.367   0.421   0.528   0.284   0.229   0.562 
##     lax laidbck withdrw givinup easygon 
##   0.663   0.248   0.362   0.557   0.549 
## 
## Loadings:
##         Factor1 Factor2 Factor3 Factor4 Factor5 Factor6 Factor7
## distant  0.586           0.121  -0.172   0.246   0.137         
## talkatv -0.760                           0.144   0.105         
## carelss         -0.280   0.137  -0.134   0.192   0.586   0.111 
## hardwrk -0.182   0.700   0.141                  -0.187         
## anxious  0.153           0.774           0.136                 
## agreebl                          0.577  -0.194           0.212 
## tense    0.150           0.787           0.208          -0.179 
## kind    -0.102   0.188           0.699  -0.118  -0.189         
## opposng                         -0.115   0.672                 
## relaxed         -0.104  -0.526   0.263                   0.491 
## disorgn         -0.340                           0.830         
## outgoin -0.834   0.107           0.166                   0.113 
## approvn -0.284   0.137           0.438  -0.142           0.214 
## shy      0.724  -0.240   0.153                                 
## discipl          0.698                          -0.164         
## harsh                           -0.265   0.619   0.132         
## persevr -0.134   0.598           0.216                         
## friendl -0.504   0.129           0.571  -0.131                 
## worryin  0.163           0.722           0.119          -0.216 
## respnsi          0.578           0.331          -0.343  -0.152 
## contrar                  0.159  -0.162   0.730   0.120         
## sociabl -0.733                   0.263                         
## lazy     0.167  -0.664   0.152           0.163   0.208   0.130 
## coopera          0.136  -0.123   0.603  -0.248                 
## quiet    0.789  -0.157   0.191   0.173                         
## organiz          0.433                          -0.753         
## criticl          0.112   0.124           0.614  -0.122         
## lax             -0.355           0.102           0.227   0.377 
## laidbck         -0.102  -0.288                   0.109   0.801 
## withdrw  0.720           0.172  -0.150   0.224   0.105         
## givinup  0.337  -0.438   0.280  -0.165   0.136   0.115         
## easygon -0.159  -0.116  -0.245   0.302                   0.508 
## 
##                Factor1 Factor2 Factor3 Factor4 Factor5 Factor6 Factor7
## SS loadings      4.501   3.076   2.494   2.403   2.221   2.068   1.560
## Proportion Var   0.141   0.096   0.078   0.075   0.069   0.065   0.049
## Cumulative Var   0.141   0.237   0.315   0.390   0.459   0.524   0.573
## 
## Test of the hypothesis that 7 factors are sufficient.
## The chi square statistic is 460.58 on 293 degrees of freedom.
## The p-value is 0.00000000137</code></pre>
<p>Vi benytter her 8 faktorer:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">fapers8 &lt;-<span class="st"> </span><span class="kw">factanal</span>(personality,<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb35-2" data-line-number="2">fapers8</a></code></pre></div>
<pre><code>## 
## Call:
## factanal(x = personality, factors = 8)
## 
## Uniquenesses:
## distant talkatv carelss hardwrk anxious agreebl   tense    kind opposng 
##   0.534   0.375   0.484   0.425   0.342   0.204   0.263   0.439   0.533 
## relaxed disorgn outgoin approvn     shy discipl   harsh persevr friendl 
##   0.417   0.170   0.257   0.649   0.364   0.490   0.468   0.497   0.333 
## worryin respnsi contrar sociabl    lazy coopera   quiet organiz criticl 
##   0.347   0.420   0.391   0.365   0.420   0.502   0.276   0.236   0.565 
##     lax laidbck withdrw givinup easygon 
##   0.682   0.005   0.367   0.550   0.580 
## 
## Loadings:
##         Factor1 Factor2 Factor3 Factor4 Factor5 Factor6 Factor7 Factor8
## distant  0.587           0.103  -0.118   0.262   0.134                 
## talkatv -0.761                           0.152   0.104                 
## carelss         -0.307   0.115           0.218   0.584          -0.108 
## hardwrk -0.182   0.694   0.139                  -0.188                 
## anxious  0.149           0.772           0.144                         
## agreebl                          0.795  -0.173           0.140  -0.327 
## tense    0.150           0.796           0.211          -0.152         
## kind    -0.118   0.227           0.615  -0.151  -0.182           0.238 
## opposng                  0.102  -0.116   0.654                         
## relaxed         -0.108  -0.535   0.276                   0.441         
## disorgn         -0.336                           0.836                 
## outgoin -0.836   0.107           0.147                                 
## approvn -0.294   0.129           0.445  -0.135           0.163         
## shy      0.729  -0.224   0.161                                   0.153 
## discipl          0.677                          -0.168          -0.105 
## harsh                           -0.178   0.658   0.124          -0.195 
## persevr -0.133   0.644           0.127                           0.206 
## friendl -0.517   0.170           0.471  -0.160                   0.326 
## worryin  0.164           0.744           0.101          -0.170   0.177 
## respnsi          0.599           0.285          -0.337  -0.117   0.105 
## contrar                  0.153  -0.152   0.732   0.118                 
## sociabl -0.737                   0.222                   0.104   0.123 
## lazy     0.166  -0.665   0.142           0.166   0.208   0.116         
## coopera -0.112   0.143  -0.130   0.614  -0.252                         
## quiet    0.789  -0.147   0.195   0.169                           0.109 
## organiz          0.434                          -0.748                 
## criticl          0.124   0.132           0.604  -0.119                 
## lax             -0.361           0.107           0.231   0.323         
## laidbck                 -0.277                   0.105   0.942         
## withdrw  0.721           0.152  -0.111   0.241   0.101                 
## givinup  0.337  -0.465   0.254  -0.106   0.161   0.108                 
## easygon -0.169  -0.117  -0.261   0.284                   0.467         
## 
##                Factor1 Factor2 Factor3 Factor4 Factor5 Factor6 Factor7
## SS loadings      4.549   3.181   2.531   2.325   2.287   2.052   1.583
## Proportion Var   0.142   0.099   0.079   0.073   0.071   0.064   0.049
## Cumulative Var   0.142   0.242   0.321   0.393   0.465   0.529   0.578
##                Factor8
## SS loadings      0.539
## Proportion Var   0.017
## Cumulative Var   0.595
## 
## Test of the hypothesis that 8 factors are sufficient.
## The chi square statistic is 398.53 on 268 degrees of freedom.
## The p-value is 0.000000379</code></pre>
</details>
<br>
<details>
<p><summary>Spørgsmål Mediedata</summary></p>
<p>Download filen om mediedata <a href="mediedata.xlsx" download>her</a>. Importer denne i R, husk under importen at vælge det korrekte sheet, der indeholder data.</p>
<p>Datasættet omhandler danskernes medievaner, 324 danskere er blevet spurgt om deres medievaner. Datasættet indeholder følgende 11 variable.</p>
<p><strong>TV-kigning</strong><br />
samlet Antal minutter pr. dag.</p>
<p><strong>Radiolytning</strong><br />
Samlet Antal minutter pr. dag.</p>
<p><strong>Avislæsning</strong><br />
Samlet Antal minutter pr. dag.</p>
<p><strong>TV-kigning</strong><br />
Nyheder Antal minutter pr. dag. “Nyheder” omfatter “Nyheder, politik og aktuelt”</p>
<p><strong>Radiolytning</strong><br />
Nyheder Antal minutter pr. dag. “Nyheder” omfatter “Nyheder, politik og aktuelt”</p>
<p><strong>Avislæsning</strong><br />
Nyheder Antal minutter pr. dag. “Nyheder” omfatter “Nyheder, politik og aktuelt”</p>
<p><strong>Internetforbrug</strong><br />
0 Ingen internetadgang hjemme eller på arbejde<br />
1 Bruger aldrig<br />
2 Mindre end en gang om måneden<br />
3 En gang om måneden<br />
4 Flere gange om måneden<br />
5 En gang om ugen<br />
6 Flere gange om ugen<br />
7 Hver dag</p>
<p><strong>Alder</strong><br />
Alder i år</p>
<p><strong>Højest fuldførte uddannelse </strong><br />
1 Folkeskole 6.-8. klasse<br />
2 Folkeskole 9.-10. klasse<br />
3 Gymnasielle uddannelser, studentereksamen, HF, HHX, HTX<br />
4 Kort erhvervsudd. under 1-2 års varighed, F.eks AMU Arbejdsmarkedsudd., Basisår Erhvervsfaglige udd.<br />
5 Faglig udd. (håndværk, handel, landbrug mv.), F.eks. Faglærte, Social- og sundhedsassistent-udd. og tilsvarende<br />
6 Kort videreg. udd af op til 2-3 år, F.eks. Erhv.akademi, datamatiker, tandplejer, byggetekniker, installatør, HD<br />
7 Mellemlang videreg.udd. 3-4 år. Prof.bachelorer, F.eks. Diploming, sygeplejerske, skolelærer, pædagog, journalist, HA<br />
8 Universitetsbachelor. 1. del af kandidatuddannelse
9 Lang videregående uddannelse. Kandidatuddannelser af 5.-6. års varighed, F.eks. Cand.mag., cand.jur., cand.polyt. etc.<br />
10 Forskeruddannelse. Ph.d., doktor</p>
<p><strong>Kvindedummy</strong><br />
Dummy variabel kodet med kvinde=1, mand=0</p>
<p><strong>Hjemmeboendebørndummy</strong><br />
Dummy variabel kodet med Ja=1, Nej=0</p>
<p>Gennemfør en faktor analyse på datasættet.</p>
</details>
<br>
<details>
<p><summary>Spørgsmål Genderroles</summary></p>
<p>Download filen genderroles <a href="genderroles.xlsx" download>her</a> og importer den i R via File - Import Dataset.
Pas på variablene skal konverteres til dummy variable, hvor det giver mening. Man bør nok udelade variablen Region, ellers skal den ændres til et passende antal dummy variable.</p>
<p>Gennemfør en faktor analyse på datasættet.</p>
</details>
<p><br></p>
<details>
<summary>Spørgsmål Valgfri datasæt</summary>
Find et valgfrit datasæt fx. på nettet, gennemfør en faktoranalyse på dette datasæt.
</details>
<p><br>
# Klyngeanalyse</p>
<p>Vi har et datasæt bestående af 32 bilmodeller med 11 variable:</p>
<ol style="list-style-type: decimal">
<li>mpg Miles/(US) gallon<br />
</li>
<li>cyl Number of cylinders<br />
</li>
<li>disp Displacement (cu.in.)<br />
</li>
<li>hp Gross horsepower<br />
</li>
<li>drat Rear axle ratio<br />
</li>
<li>wt Weight (1000 lbs)<br />
</li>
<li>qsec 1/4 mile time<br />
</li>
<li>vs Engine (0 = V-shaped, 1 = straight)<br />
</li>
<li>am Transmission (0 = automatic, 1 = manual)<br />
</li>
<li>gear Number of forward gears<br />
</li>
<li>carb Number of carburetors</li>
</ol>
<p>Man kunne godt formode man kunne gruppere de forskellige bilmodeller i forskellige grupper eller klynger udfra deres specifikationer. For at undersøge om vi på baggrund af tekniske karakteristika kan gruppere bilmodellerne, benytter vi klyngeanalyse. Bemærk i faktoranalysen grupperer vi variablene, i klyngeanalysen grupperer vi respondenterne, her altså bilerne.</p>
<p>Der findes overordnet 2 typer af klyngeudvælgelse:</p>
<p><strong><em>Ikke-hierarkisk, k-means metoden</em></strong> benyttes, hvis vi har store datasæt hvor der kræves mange observationer, man vælger på forhånd hvor mange klynger man vil have.</p>
<p><strong><em>Hierarkisk klyngedannelse, agglomerative metode</em></strong> hvor man starter med at hver respondent har sin egen klynge og man derefter sammenhober disse trin for trin kaldes den sammenhobede eller agglomerative metode. Vi benytter til bildatasættet den agglomerative metode, da vi ikke har en stort datasæt, er denne klart at foretrække.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">pacman<span class="op">::</span><span class="kw">p_load</span>(<span class="st">&quot;datasets&quot;</span>)<span class="co">#Vi henter pakken datasets der indeholder en del datasæt</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="kw">head</span>(mtcars) <span class="co">#Vi kan se starten af datasættet med Head kommandoen</span></a></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<p>Vi kan se at når vi sammenligner forskellige variable ser det ud til at der er forskellige grupper. Nedenfor ser vi fx de 32 biler plottet i et diagram efter hestekræfter og miles per gallon. Bilerne er farvekodet med antal cylindre.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co">#Her angiver vi modelnavne for hver bil </span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="co">#med label rownames vi bruger geom_text i stedet for point her.</span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3">pacman<span class="op">::</span><span class="kw">p_load</span>(<span class="st">&quot;ggplot2&quot;</span>)</a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(hp, mpg, <span class="dt">color =</span> cyl)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_point</span>() <span class="co">#Plot med kun punkter</span></a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(hp, mpg, <span class="dt">color =</span> cyl,<span class="dt">label=</span><span class="kw">rownames</span>(mtcars)))<span class="op">+</span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">size=</span><span class="dv">3</span>,<span class="dt">check_overlap =</span> <span class="ot">TRUE</span>) </a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-23-2.png" width="672" /></p>
<p>Vi kan benytte t til at transponere data matricen, så kan vi tegne et corrplot, det er meget mørkt da alle bilerne er positivt korrelerede, men man kan ane nogle sammenhænge. t(mtcars) betyder vi transponerer (vender) matricen, så ser vi i stedet på grupper af respondenter, som vi netop analyserer i klyngeanalysen. Hvis ikke vi vender matricen ser vi på korrelationsmatricen mellem de 11 variable i stedet, ligesom vi tidligere har gjort med faktoranalysen.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="co">#korrelationsmatricen for transponeret mtcars data, hclust betyder vi ordner efter variable der passer sammen</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2">pacman<span class="op">::</span><span class="kw">p_load</span>(corrplot)</a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="kw">corrplot</span>(<span class="kw">cor</span>(<span class="kw">t</span>(mtcars)), <span class="dt">order =</span> <span class="st">&quot;hclust&quot;</span>, <span class="dt">tl.col=</span><span class="st">&#39;black&#39;</span>, <span class="dt">tl.cex=</span>.<span class="dv">5</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-24-1.svg" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="co">#Her er korrelationsmatricen ikke transponeret, hvilket svarer til en matrice baseret på variable som ved faktoranalysen vi tidligere så på.</span></a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="kw">corrplot</span>(<span class="kw">cor</span>(mtcars), <span class="dt">order =</span> <span class="st">&quot;hclust&quot;</span>, <span class="dt">tl.col=</span><span class="st">&#39;black&#39;</span>, <span class="dt">tl.cex=</span>.<span class="dv">5</span>) </a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
</div>
<div id="hierakisk-klyngeanalyse-hclust-kommandoen" class="section level2">
<h2><span class="header-section-number">5.5</span> Hierakisk klyngeanalyse hclust kommandoen</h2>
<p>Vi får nu R til at danne klynger vha. af hclust (hierarcical cluster) kommandoen, denne benytter default en metode der hedder complete til at finde ens klynger, der findes mange andre metoder. For at benytte hclust skal R først beregne afstandene mellem bilerne dette gøres med dist kommandoen. Algoritmen beregner afstandene mellem de forskellige bilmodeller vha. af den euklidiske metrik. Biler med kort afstand kommer i klynger sammen, biler med lang afstand kommer i forskellige klynger.</p>
<p>Nedenfor ses et udsnit af afstandende mellem hver af de 32 biler, det er en meget stor 32 <span class="math inline">\(\times\)</span> 32 matrice, derfor har vi benyttet head for kun at vise noget af matricen. Fx er afstanden mellem to forskellige biler som en Mazda RX4 og en Lincoln Continental 318.05 hvilket er en stor afstand i forhold til fx. Mazda RX4 og Mazda RX4 Wag på kun 0.62. Bemærk hvordan supersportsvognen Maserati Bora har store afstande til de fleste af de øvrige biler, Maseratien var en komfortabel, rummeligere og kraftigere og tungere sportsvogn end fx. Ferrari Dino.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">head</span>(<span class="kw">as.matrix</span>(<span class="kw">dist</span>(mtcars))) </a></code></pre></div>
<pre><code>##                     Mazda RX4 Mazda RX4 Wag Datsun 710 Hornet 4 Drive
## Mazda RX4           0.0000000     0.6153251   54.90861       98.11252
## Mazda RX4 Wag       0.6153251     0.0000000   54.89152       98.09589
## Datsun 710         54.9086059    54.8915169    0.00000      150.99352
## Hornet 4 Drive     98.1125212    98.0958939  150.99352        0.00000
## Hornet Sportabout 210.3374396   210.3358546  265.08316      121.02976
## Valiant            65.4717710    65.4392224  117.75470       33.55087
##                   Hornet Sportabout   Valiant Duster 360 Merc 240D
## Mazda RX4                  210.3374  65.47177  241.40765  50.15327
## Mazda RX4 Wag              210.3359  65.43922  241.40887  50.11461
## Datsun 710                 265.0832 117.75470  294.47902  49.65848
## Hornet 4 Drive             121.0298  33.55087  169.42996 121.27397
## Hornet Sportabout            0.0000 152.12414   70.17673 241.50697
## Valiant                    152.1241   0.00000  194.60945  89.59111
##                    Merc 230  Merc 280 Merc 280C Merc 450SE Merc 450SL
## Mazda RX4          25.46831  15.36419  15.67247  135.43070  135.40144
## Mazda RX4 Wag      25.32845  15.29569  15.58377  135.42548  135.39604
## Datsun 710         33.18038  66.93635  67.02614  189.19549  189.16317
## Hornet 4 Drive    118.24331  91.42240  91.46129   72.49643   72.43135
## Hornet Sportabout 233.49240 199.33450 199.34066   84.38885   84.36840
## Valiant            85.00796  60.29098  60.26557   90.69703   90.67697
##                   Merc 450SLC Cadillac Fleetwood Lincoln Continental
## Mazda RX4           135.47947           326.3396            318.0470
## Mazda RX4 Wag       135.47232           326.3355            318.0429
## Datsun 710          189.23454           381.0926            372.8012
## Hornet 4 Drive       72.57185           234.4404            227.9726
## Hornet Sportabout    84.43324           116.2804            108.0624
## Valiant              90.70930           266.6281            259.6304
##                   Chrysler Imperial  Fiat 128 Honda Civic Toyota Corolla
## Mazda RX4                 304.72034  93.26800   102.83076       100.6040
## Mazda RX4 Wag             304.71692  93.25310   102.82387       100.5888
## Datsun 710                359.30149  40.99338    52.77046        47.6535
## Hornet 4 Drive            218.15483 184.96897   191.55187       192.6714
## Hornet Sportabout          97.20491 302.03772   310.03246       309.5582
## Valiant                   248.77133 152.11533   158.96158       159.8303
##                   Toyota Corona Dodge Challenger AMC Javelin Camaro Z28
## Mazda RX4              42.30752        163.11508   149.60472  233.22288
## Mazda RX4 Wag          42.26592        163.11342   149.60145  233.22487
## Datsun 710             12.96547        217.77958   204.31889  286.00492
## Hornet 4 Drive        138.53047         72.44039    61.36019  163.66326
## Hornet Sportabout     252.33320         48.98389    61.42742   70.96653
## Valiant               105.28764        103.43107    91.04443  187.84638
##                   Pontiac Firebird Fiat X1-9 Porsche 914-2 Lotus Europa
## Mazda RX4                248.67803  92.50484      44.40337     65.73284
## Mazda RX4 Wag            248.67620  92.49400      44.40736     65.73626
## Datsun 710               303.35839  39.88151      13.13571     25.09486
## Hornet 4 Drive           156.22403 184.44712     139.15795    163.23674
## Hornet Sportabout         40.00525 301.56695     254.14526    272.35824
## Valiant                  188.52721 151.43794     106.05858    130.82482
##                   Ford Pantera L Ferrari Dino Maserati Bora Volvo 142E
## Mazda RX4               245.4247     66.76610      265.6454   39.18940
## Mazda RX4 Wag           245.4294     66.77642      265.6491   39.16260
## Datsun 710              297.2940     90.24155      309.7718   20.69394
## Hornet 4 Drive          180.1140    130.55230      229.3419  137.03633
## Hornet Sportabout        89.5934    215.06739      170.7094  248.00634
## Valiant                 203.0178    106.56948      242.4393  104.18637</code></pre>
<p>Vi gemmer hclust data i clusters variablen, vi så kan benytte til at tegne en oversigt over klyngerne.
Vi kan nu plotte en grafisk oversigt over bilerne. I nederste linje er den fineste inddeling, hvor samtlige biler er i deres egen klynge. Den blå linje med 3 skæringer i dendogrammet indikerer der er 3 klynger, den røde 4 klynger.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">clusters &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(mtcars))</a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="kw">plot</span>(clusters,<span class="dt">cex=</span><span class="fl">0.5</span>,<span class="dt">main =</span> <span class="st">&quot;Dendogram af mtcars&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;Klyngetræ&quot;</span>,<span class="dt">sub=</span><span class="st">&quot;Bilmodeller&quot;</span>)</a>
<a class="sourceLine" id="cb45-3" data-line-number="3"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">190</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="co">#Tegn rød vandret linje h betyder horisontal</span></a>
<a class="sourceLine" id="cb45-4" data-line-number="4"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">230</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-27-1.svg" width="672" /></p>
<p>Hvis vi ønsker at undersøge en indeling med et bestemt antal klynger, kan vi bruge cutree i R, til at undersøge klyngerne i en skæring med fx. 4 klynger nærmere. Her ser vi som nævnt, Maserati Bora skiller sig ud ved at have sin egen klynge. Nummeret ved hver af de 32 biler angiver hvilken klynge bilen tilhører.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">clusterCut &lt;-<span class="st"> </span><span class="kw">cutree</span>(clusters, <span class="dv">4</span>) <span class="co">#Opdeling i 4 klynger.</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2">clusterCut</a></code></pre></div>
<pre><code>##           Mazda RX4       Mazda RX4 Wag          Datsun 710 
##                   1                   1                   1 
##      Hornet 4 Drive   Hornet Sportabout             Valiant 
##                   2                   3                   2 
##          Duster 360           Merc 240D            Merc 230 
##                   3                   1                   1 
##            Merc 280           Merc 280C          Merc 450SE 
##                   1                   1                   2 
##          Merc 450SL         Merc 450SLC  Cadillac Fleetwood 
##                   2                   2                   3 
## Lincoln Continental   Chrysler Imperial            Fiat 128 
##                   3                   3                   1 
##         Honda Civic      Toyota Corolla       Toyota Corona 
##                   1                   1                   1 
##    Dodge Challenger         AMC Javelin          Camaro Z28 
##                   2                   2                   3 
##    Pontiac Firebird           Fiat X1-9       Porsche 914-2 
##                   3                   1                   1 
##        Lotus Europa      Ford Pantera L        Ferrari Dino 
##                   1                   3                   1 
##       Maserati Bora          Volvo 142E 
##                   4                   1</code></pre>
<p>Vi kan benytte subset kommandoen til at se på hvilke variable der er i hver klynge, herunder ser vi på klynge 3.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">subset</span>(clusterCut,clusterCut<span class="op">==</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   Hornet Sportabout          Duster 360  Cadillac Fleetwood 
##                   3                   3                   3 
## Lincoln Continental   Chrysler Imperial          Camaro Z28 
##                   3                   3                   3 
##    Pontiac Firebird      Ford Pantera L 
##                   3                   3</code></pre>
<p>Vi kan ligeledes sammenligne klyngeinddelingen med de enkelte variable og se om disse passer sammen. Fx. passer hp meget fint med inddelingen i klynger.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">table</span>(clusterCut, mtcars<span class="op">$</span>cyl)</a></code></pre></div>
<pre><code>##           
## clusterCut  4  6  8
##          1 11  5  0
##          2  0  2  5
##          3  0  0  8
##          4  0  0  1</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw">table</span>(clusterCut, mtcars<span class="op">$</span>mpg)</a></code></pre></div>
<pre><code>##           
## clusterCut 10.4 13.3 14.3 14.7 15 15.2 15.5 15.8 16.4 17.3 17.8 18.1 18.7
##          1    0    0    0    0  0    0    0    0    0    0    1    0    0
##          2    0    0    0    0  0    2    1    0    1    1    0    1    0
##          3    2    1    1    1  0    0    0    1    0    0    0    0    1
##          4    0    0    0    0  1    0    0    0    0    0    0    0    0
##           
## clusterCut 19.2 19.7 21 21.4 21.5 22.8 24.4 26 27.3 30.4 32.4 33.9
##          1    1    1  2    1    1    2    1  1    1    2    1    1
##          2    0    0  0    1    0    0    0  0    0    0    0    0
##          3    1    0  0    0    0    0    0  0    0    0    0    0
##          4    0    0  0    0    0    0    0  0    0    0    0    0</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">table</span>(clusterCut, mtcars<span class="op">$</span>hp)</a></code></pre></div>
<pre><code>##           
## clusterCut 52 62 65 66 91 93 95 97 105 109 110 113 123 150 175 180 205 215
##          1  1  1  1  2  1  1  1  1   0   1   2   1   2   0   1   0   0   0
##          2  0  0  0  0  0  0  0  0   1   0   1   0   0   2   0   3   0   0
##          3  0  0  0  0  0  0  0  0   0   0   0   0   0   0   2   0   1   1
##          4  0  0  0  0  0  0  0  0   0   0   0   0   0   0   0   0   0   0
##           
## clusterCut 230 245 264 335
##          1   0   0   0   0
##          2   0   0   0   0
##          3   1   2   1   0
##          4   0   0   0   1</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="kw">table</span>(clusterCut, mtcars<span class="op">$</span>carb)</a></code></pre></div>
<pre><code>##           
## clusterCut 1 2 3 4 6 8
##          1 5 6 0 4 1 0
##          2 2 2 3 0 0 0
##          3 0 2 0 6 0 0
##          4 0 0 0 0 0 1</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw">table</span>(clusterCut, mtcars<span class="op">$</span>wt)</a></code></pre></div>
<pre><code>##           
## clusterCut 1.513 1.615 1.835 1.935 2.14 2.2 2.32 2.465 2.62 2.77 2.78
##          1     1     1     1     1    1   1    1     1    1    1    1
##          2     0     0     0     0    0   0    0     0    0    0    0
##          3     0     0     0     0    0   0    0     0    0    0    0
##          4     0     0     0     0    0   0    0     0    0    0    0
##           
## clusterCut 2.875 3.15 3.17 3.19 3.215 3.435 3.44 3.46 3.52 3.57 3.73 3.78
##          1     1    1    0    1     0     0    2    0    0    0    0    0
##          2     0    0    0    0     1     1    0    1    1    0    1    1
##          3     0    0    1    0     0     0    1    0    0    1    0    0
##          4     0    0    0    0     0     0    0    0    0    1    0    0
##           
## clusterCut 3.84 3.845 4.07 5.25 5.345 5.424
##          1    0     0    0    0     0     0
##          2    0     0    1    0     0     0
##          3    1     1    0    1     1     1
##          4    0     0    0    0     0     0</code></pre>
<p>Hvis dendogrammet virker lidt uoverskueligt, kan man vælge ape pakken for at lave mere fancy plots, her er rigtig mange muligheder.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="co">#install.packages(&quot;ape&quot;)</span></a>
<a class="sourceLine" id="cb60-2" data-line-number="2"><span class="kw">library</span>(<span class="st">&quot;ape&quot;</span>)</a>
<a class="sourceLine" id="cb60-3" data-line-number="3">colors =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;pink&quot;</span>)</a>
<a class="sourceLine" id="cb60-4" data-line-number="4">clus4 =<span class="st"> </span><span class="kw">cutree</span>(clusters, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb60-5" data-line-number="5"><span class="kw">plot</span>(<span class="kw">as.phylo</span>(clusters), <span class="dt">type =</span> <span class="st">&quot;fan&quot;</span>, <span class="dt">tip.color =</span> colors[clus4],</a>
<a class="sourceLine" id="cb60-6" data-line-number="6">     <span class="dt">label.offset =</span> <span class="dv">0</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-31-1.svg" width="672" /></p>
<p>Herunder er et plot, hvor farvekoden er baseret på klyngerne.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(hp, mpg)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.4</span>, <span class="dt">size =</span> <span class="fl">3.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">col =</span> clusterCut) </a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-32-1.svg" width="672" /></p>
</div>
<div id="ikke-hierakisk-klyngeanalyse-kmeans-kommandoen" class="section level2">
<h2><span class="header-section-number">5.6</span> Ikke hierakisk klyngeanalyse kmeans kommandoen</h2>
<p>Vi kunne også have brugt kmeans metoden, her skal vi så angive hvor mange klynger, vi ønsker i analysen. Her benytter vi K-means og får 4 klynger med 7, 6, 9, 10 biler. I output fra R kan vi under Cluster means se gennemsnit, for de 4 klynger for alle 11 variable.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">mtcarsCluster4 &lt;-<span class="st"> </span><span class="kw">kmeans</span>(mtcars, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb62-2" data-line-number="2">mtcarsCluster4</a></code></pre></div>
<pre><code>## K-means clustering with 4 clusters of sizes 10, 7, 11, 4
## 
## Cluster means:
##        mpg cyl     disp        hp     drat       wt     qsec        vs
## 1 15.67000   8 317.1400 210.40000 3.297000 3.612500 16.45400 0.0000000
## 2 19.74286   6 183.3143 122.28571 3.585714 3.117143 17.97714 0.5714286
## 3 26.66364   4 105.1364  82.63636 4.070909 2.285727 19.13727 0.9090909
## 4 13.67500   8 443.0000 206.25000 3.060000 4.966000 17.56750 0.0000000
##          am     gear     carb
## 1 0.2000000 3.400000 3.500000
## 2 0.4285714 3.857143 3.428571
## 3 0.7272727 4.090909 1.545455
## 4 0.0000000 3.000000 3.500000
## 
## Clustering vector:
##           Mazda RX4       Mazda RX4 Wag          Datsun 710 
##                   2                   2                   3 
##      Hornet 4 Drive   Hornet Sportabout             Valiant 
##                   2                   1                   2 
##          Duster 360           Merc 240D            Merc 230 
##                   1                   3                   3 
##            Merc 280           Merc 280C          Merc 450SE 
##                   2                   2                   1 
##          Merc 450SL         Merc 450SLC  Cadillac Fleetwood 
##                   1                   1                   4 
## Lincoln Continental   Chrysler Imperial            Fiat 128 
##                   4                   4                   3 
##         Honda Civic      Toyota Corolla       Toyota Corona 
##                   3                   3                   3 
##    Dodge Challenger         AMC Javelin          Camaro Z28 
##                   1                   1                   1 
##    Pontiac Firebird           Fiat X1-9       Porsche 914-2 
##                   4                   3                   3 
##        Lotus Europa      Ford Pantera L        Ferrari Dino 
##                   3                   1                   2 
##       Maserati Bora          Volvo 142E 
##                   1                   3 
## 
## Within cluster sum of squares by cluster:
## [1] 43649.519 13954.336 11848.370  4665.041
##  (between_SS / total_SS =  88.1 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;    
## [5] &quot;tot.withinss&quot; &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;        
## [9] &quot;ifault&quot;</code></pre>
<p>Nedenfor ser vi på en tabel inddeling med 4 klynger med de 32 biler, sorteret efter antallet af cylindre.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="kw">table</span>(mtcarsCluster4<span class="op">$</span>cluster, mtcars<span class="op">$</span>cyl)</a></code></pre></div>
<pre><code>##    
##      4  6  8
##   1  0  0 10
##   2  0  7  0
##   3 11  0  0
##   4  0  0  4</code></pre>
<p>Nedenfor ser vi på en tabel inddeling med 3 klynger med de 32 biler, sorteret efter antallet af cylindre. Kører vi kmeans analysen igen, falder bilerne ikke nødvendigvis i samme klynger som tidligere, det skyldes algoritmen kan give forskellig optimale inddelinger.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">mtcarsCluster3 &lt;-<span class="st"> </span><span class="kw">kmeans</span>(mtcars, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb66-2" data-line-number="2"><span class="kw">table</span>(mtcarsCluster3<span class="op">$</span>cluster, mtcars<span class="op">$</span>cyl)</a></code></pre></div>
<pre><code>##    
##      4  6  8
##   1  0  7  0
##   2  0  0 14
##   3 11  0  0</code></pre>
</div>
<div id="validering-med-anova" class="section level2">
<h2><span class="header-section-number">5.7</span> Validering med ANOVA</h2>
<p>Skal man undersøge om grupperne/klyngerne er forskellige med hensyn til de forskellige variable, kan man benytte Anova, hvor klyngerne er den uafhængige variabel. Man skal da gerne nå frem til at klyngegennemsnittede er signifikant forskellige mht. flere af variablene der indgår i analysen.</p>
<!-- Undersøg om der er forskel på hestekræfter hp i de 5 klynger dannet af kmeans analysen hvis du vil gennemføre Anova analysen i Freestat skal du eksportere datasættet.   -->
<!-- Du kan benytte kmeans og export (rio pakken) kommandoerne   -->
<!-- Man kan danne en kvalitativ variabel med fx. 3 klynger med kmeans kommandoen   -->
<!-- Og klistre den på kmeansdatasættet med cbind kommandoen, desværre driller rio pakken på mange windows maskiner. -->
<!-- ```{r} -->
<!-- # install.packages("rio") -->
<!-- library(rio) -->
<!-- mtcarsklynge <- as.data.frame(cbind(kmeans(mtcars,3)$cluster,mtcars$hp)) -->
<!-- export(mtcarsklynge,"mtcarsklynge.xlsx") -->
<!-- ``` -->
<!-- <!-- Der er små forskelle i p-værdierne mellem Freestat og R Anova testet da algoritmerne beregner efter lidt forskellige metoder. -->
<!-- # ```{r} -->
<!-- # anova(lm(mtcarsklynge$V2 ~ mtcarsklynge$V1,data=mtcarsklynge)) -->
<!-- <!-- ``` -->
<details>
<p><summary>Spørgsmål US arrestationer samt urbaniseringsgrad</summary></p>
<p>Lav en klyngeanalyse for datasæt med 50 observationer for amerikanske stater på 4 variable, data stammer fra World Almanac and Book of facts 1975. (Crime rates).</p>
<ol style="list-style-type: decimal">
<li>Mord, antal arrestationer (pr 100,000)<br />
</li>
<li>Overfald, antal arrestationer (pr 100,000)<br />
</li>
<li>Urbaniseringsgrad andel af bybefolkning.<br />
</li>
<li>Voldtægt, antal arrestationer (pr 100,000)</li>
</ol>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1">pacman<span class="op">::</span><span class="kw">p_load</span>(datasets)</a>
<a class="sourceLine" id="cb68-2" data-line-number="2">arrest &lt;-<span class="st"> </span>USArrests</a>
<a class="sourceLine" id="cb68-3" data-line-number="3"><span class="kw">head</span>(arrest)</a></code></pre></div>
<pre><code>##            Murder Assault UrbanPop Rape
## Alabama      13.2     236       58 21.2
## Alaska       10.0     263       48 44.5
## Arizona       8.1     294       80 31.0
## Arkansas      8.8     190       50 19.5
## California    9.0     276       91 40.6
## Colorado      7.9     204       78 38.7</code></pre>
<p>Undersøg om der kan dannes klynger og hvorledes disse kan karakteriseres. Illustrer grafisk og kommenter på karakteristika for klyngerne.</p>
</details>
<br>
<details>
<p><summary>Spørgsmål GDP</summary></p>
<p>Download filen om GDP og GDP per capita <a href="GDP.xlsx" download>her</a>. Importer denne i R. Sørg for at få navnene for de enkelte lande som label, dette kan du fx. gøre ved nedenstående kommando:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">GDP &lt;-<span class="st"> </span>GDP[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,]</a>
<a class="sourceLine" id="cb70-2" data-line-number="2"><span class="kw">row.names</span>(GDP) &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(GDP[,<span class="dv">1</span>])</a></code></pre></div>
Undersøg om der kan dannes klynger og hvorledes disse kan karakteriseres, der er rigtig mange observationer dvs. lande, se i stedet på deldatasæt der giver mening. Illustrer grafisk og kommenter på karakteristika for klyngerne.
</details>
<br>
<details>
<p><summary>Spørgsmål Forbes 100 US</summary></p>
<p>Download filen om de 100 rigeste i USA <a href="Forbes400.xlsx" download>her</a>. Filen er tilrettet dvs., dvs. binære kvalitative variable skal kodes om.</p>
<p>Undersøg om der kan dannes klynger og hvorledes disse kan karakteriseres. Illustrer grafisk og kommenter på karakteristika for klyngerne.</p>
<p>Bemærk det er godt at sætte navnene på de velhavende som rækkenavne i din data.frame, for at det er nemmere at få et overblik i klyngetræ diagrammet, dette kan du fx. gøre som nedenfor:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw">row.names</span>(Forbes100) &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(Forbes100[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb71-2" data-line-number="2">clusters &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(Forbes100))</a>
<a class="sourceLine" id="cb71-3" data-line-number="3"><span class="kw">plot</span>(clusters,<span class="dt">cex=</span><span class="fl">0.5</span>,<span class="dt">main =</span> <span class="st">&quot;US 100 Rigeste&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;Klyngetræ&quot;</span>,<span class="dt">sub=</span><span class="st">&quot;US top 100&quot;</span>)</a></code></pre></div>
</details>
<p><br></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cran-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="kvantitative-metoder.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
