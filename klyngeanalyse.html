<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Kvantitative metoder for de finansielle uddannelser.</title>
  <meta name="description" content="Kvantitative metoder.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Kvantitative metoder for de finansielle uddannelser." />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Kvantitative metoder." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kvantitative metoder for de finansielle uddannelser." />
  
  <meta name="twitter:description" content="Kvantitative metoder." />
  

<meta name="author" content="Thomas Petersen">


<meta name="date" content="2018-09-28">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="prev" href="faktoranalyse.html">
<link rel="next" href="us-arrestationer-samt-urbaniseringsgrad.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistik</a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="1" data-path="sandsynligheder.html"><a href="sandsynligheder.html"><i class="fa fa-check"></i><b>1</b> Sandsynligheder</a><ul>
<li class="chapter" data-level="1.0.1" data-path="sandsynligheder.html"><a href="sandsynligheder.html#forenings--og-flleshndelser"><i class="fa fa-check"></i><b>1.0.1</b> Forenings- og fælleshændelser</a></li>
<li class="chapter" data-level="1.1" data-path="sandsynligheder.html"><a href="sandsynligheder.html#betingede-sandsynligheder"><i class="fa fa-check"></i><b>1.1</b> Betingede sandsynligheder</a><ul>
<li class="chapter" data-level="1.1.1" data-path="sandsynligheder.html"><a href="sandsynligheder.html#race-og-ddsdom-eksempel"><i class="fa fa-check"></i><b>1.1.1</b> Race og dødsdom eksempel</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="sandsynligheder.html"><a href="sandsynligheder.html#uafhngighed"><i class="fa fa-check"></i><b>1.2</b> Uafhængighed</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html"><i class="fa fa-check"></i><b>2</b> Chi i anden tests</a><ul>
<li class="chapter" data-level="2.1" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html#goodness-of-fit-test"><i class="fa fa-check"></i><b>2.1</b> Goodness of fit test</a></li>
<li class="chapter" data-level="2.2" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html#forudstning"><i class="fa fa-check"></i><b>2.2</b> Forudsætning</a></li>
<li class="chapter" data-level="2.3" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html#chi-i-anden-test"><i class="fa fa-check"></i><b>2.3</b> Chi i anden test</a></li>
<li class="chapter" data-level="2.4" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html#chi-i-anden-test-2"><i class="fa fa-check"></i><b>2.4</b> Chi i anden test 2</a><ul>
<li class="chapter" data-level="2.4.1" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html#uafhngighed-1"><i class="fa fa-check"></i><b>2.4.1</b> Uafhængighed</a></li>
<li class="chapter" data-level="2.4.2" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html#anmeldte-skader-fordelt-pa-regioner-og-antal-skader"><i class="fa fa-check"></i><b>2.4.2</b> Anmeldte skader fordelt på regioner og antal skader</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="chi-i-anden-tests.html"><a href="chi-i-anden-tests.html#selvtest"><i class="fa fa-check"></i><b>2.5</b> Selvtest</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>3</b> ANOVA</a><ul>
<li class="chapter" data-level="3.1" data-path="anova.html"><a href="anova.html#selvtest-1"><i class="fa fa-check"></i><b>3.1</b> Selvtest</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cran-r.html"><a href="cran-r.html"><i class="fa fa-check"></i><b>4</b> Cran R</a><ul>
<li class="chapter" data-level="4.1" data-path="cran-r.html"><a href="cran-r.html#r-video-tutorials"><i class="fa fa-check"></i><b>4.1</b> R video-tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="faktoranalyse.html"><a href="faktoranalyse.html"><i class="fa fa-check"></i><b>5</b> Faktoranalyse</a><ul>
<li class="chapter" data-level="5.1" data-path="faktoranalyse.html"><a href="faktoranalyse.html#hvilke-faktorer-er-vigtige-nar-man-kber-en-ny-computer"><i class="fa fa-check"></i><b>5.1</b> Hvilke faktorer er vigtige når man køber en ny computer:</a></li>
<li class="chapter" data-level="5.2" data-path="faktoranalyse.html"><a href="faktoranalyse.html#forudstninger-for-faktoranalysen."><i class="fa fa-check"></i><b>5.2</b> Forudsætninger for faktoranalysen.</a></li>
<li class="chapter" data-level="5.3" data-path="faktoranalyse.html"><a href="faktoranalyse.html#selve-faktoranalysen"><i class="fa fa-check"></i><b>5.3</b> Selve Faktoranalysen</a></li>
<li class="chapter" data-level="5.4" data-path="faktoranalyse.html"><a href="faktoranalyse.html#hvor-mange-faktorer-br-benyttes"><i class="fa fa-check"></i><b>5.4</b> Hvor mange faktorer bør benyttes?</a><ul>
<li class="chapter" data-level="5.4.1" data-path="faktoranalyse.html"><a href="faktoranalyse.html#eigenvalues-metoden"><i class="fa fa-check"></i><b>5.4.1</b> Eigenvalues metoden</a></li>
<li class="chapter" data-level="5.4.2" data-path="faktoranalyse.html"><a href="faktoranalyse.html#screeplot-metoden"><i class="fa fa-check"></i><b>5.4.2</b> Screeplot metoden</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="klyngeanalyse.html"><a href="klyngeanalyse.html"><i class="fa fa-check"></i><b>6</b> Klyngeanalyse</a></li>
<li class="chapter" data-level="7" data-path="us-arrestationer-samt-urbaniseringsgrad.html"><a href="us-arrestationer-samt-urbaniseringsgrad.html"><i class="fa fa-check"></i><b>7</b> US arrestationer samt urbaniseringsgrad</a></li>
<li class="chapter" data-level="8" data-path="kvantitative-metoder.html"><a href="kvantitative-metoder.html"><i class="fa fa-check"></i><b>8</b> Kvantitative metoder</a></li>
<li class="chapter" data-level="9" data-path="arima000.html"><a href="arima000.html"><i class="fa fa-check"></i><b>9</b> ARIMA(0,0,0)</a></li>
<li class="chapter" data-level="10" data-path="arima100-eller-ar1-autoregression.html"><a href="arima100-eller-ar1-autoregression.html"><i class="fa fa-check"></i><b>10</b> ARIMA(1,0,0) eller AR(1) autoregression</a></li>
<li class="chapter" data-level="11" data-path="arima010-eller-i1-random-walk-with-a-drift.html"><a href="arima010-eller-i1-random-walk-with-a-drift.html"><i class="fa fa-check"></i><b>11</b> ARIMA(0,1,0) eller I(1) Random Walk with a drift</a></li>
<li class="chapter" data-level="12" data-path="arima001-eller-ma1-moving-average.html"><a href="arima001-eller-ma1-moving-average.html"><i class="fa fa-check"></i><b>12</b> ARIMA(0,0,1) eller MA(1) Moving average</a></li>
<li class="chapter" data-level="13" data-path="plots-med-forskellige-modeller.html"><a href="plots-med-forskellige-modeller.html"><i class="fa fa-check"></i><b>13</b> Plots med forskellige modeller</a></li>
<li class="chapter" data-level="14" data-path="arima-og-ssonalitet.html"><a href="arima-og-ssonalitet.html"><i class="fa fa-check"></i><b>14</b> ARIMA og sæsonalitet</a><ul>
<li class="chapter" data-level="14.1" data-path="arima-og-ssonalitet.html"><a href="arima-og-ssonalitet.html#traktorer"><i class="fa fa-check"></i><b>14.1</b> Traktorer</a></li>
<li class="chapter" data-level="14.2" data-path="arima-og-ssonalitet.html"><a href="arima-og-ssonalitet.html#detail-debet-card-forbrug-pa-island-millioner-isk."><i class="fa fa-check"></i><b>14.2</b> Detail debet card forbrug på Island (millioner ISK).</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="forecast-aktiekurser.html"><a href="forecast-aktiekurser.html"><i class="fa fa-check"></i><b>15</b> Forecast Aktiekurser</a></li>
<li class="divider"></li>
<li><a href="https://tepedu.com" target="blank">Thomas Petersen</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Kvantitative metoder for de finansielle uddannelser.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="klyngeanalyse" class="section level1">
<h1><span class="header-section-number">Kapitel 6</span> Klyngeanalyse</h1>
<p>Vi har et datasæt bestående af 32 bilmodeller med 11 variable:</p>
<p>[, 1] mpg Miles/(US) gallon<br />
[, 2] cyl Number of cylinders<br />
[, 3] disp Displacement (cu.in.)<br />
[, 4] hp Gross horsepower<br />
[, 5] drat Rear axle ratio<br />
[, 6] wt Weight (1000 lbs)<br />
[, 7] qsec 1/4 mile time<br />
[, 8] vs V/S<br />
[, 9] am Transmission (0 = automatic, 1 = manual)<br />
[,10] gear Number of forward gears<br />
[,11] carb Number of carburetors</p>
<p>Man kunne godt formode man kunne gruppere de forskellige bilmodeller i forskellige grupper eller klynger udfra deres specifikationer. For at undersøge om vi på baggrund af tekniske karakteristika kan gruppere bilmodellerne, benytter vi klyngeanalyse. Bemærk i faktoranalysen grupperer vi variablene, i klyngeanalysen grupperer vi respondenterne, her altså bilerne.</p>
<p>Der findes overordnet 2 typer af klyngeudvælgelse, ikke-hierarkisk k-means metoden og hierarkisk klyngedannelse. k-means metoden benyttes, hvis vi har store datasæt hvor der kræves mange observationer, man vælger på forhånd hvor mange klynger man vil have. En hierarkisk klyngedannelse, hvor man starter med at hver respondent har sin egen klynge og man derefter sammenhober disse trin for trin kaldes den sammenhobede eller agglomerative metode. Vi benytter først den agglomerative metode, da vi ikke har en stort datasæt er denne klart at foretrække.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="co">#install.packages(&quot;datasets&quot;)</span></a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="kw">library</span>(datasets)</a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="kw">head</span>(mtcars) <span class="co">#Vi kan se starten af datasættet med Head kommandoen</span></a></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<p>Vi kan se at når vi sammenligner forskellige variable ser det ud til at der er forskellige grupper. Nedenfor ser vi fx de 32 biler plottet i et diagram efter hestekræfter og miles per gallon. Bilerne er farvekodet med antal cylindre.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co">#install.packages(&quot;ggplot2&quot;, dev=&#39;svg&#39;)</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="kw">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(hp, mpg, <span class="dt">color =</span> cyl)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="co">#Plot med kun punkter</span></a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(hp, mpg, <span class="dt">color =</span> cyl,<span class="dt">label=</span><span class="kw">rownames</span>(mtcars))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_text</span>(<span class="dt">size=</span><span class="dv">3</span>,<span class="dt">check_overlap =</span> <span class="ot">TRUE</span>) <span class="co">#Her angiver vi modelnavne for hver bil med label rownames vi bruger geom_text i stedet for point her.</span></a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-23-2.png" width="672" /></p>
<p>Vi kan benytte t til at transponere data matricen, så kan vi tegne et corrplot, det er meget mørkt da alle bilerne er positivt korrelerede, men man kan ane nogle sammenhænge.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">library</span>(corrplot)</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="kw">corrplot</span>(<span class="kw">cor</span>(<span class="kw">t</span>(mtcars)), <span class="dt">order =</span> <span class="st">&quot;hclust&quot;</span>, <span class="dt">tl.col=</span><span class="st">&#39;black&#39;</span>, <span class="dt">tl.cex=</span>.<span class="dv">5</span>) <span class="co">#transponeret mtcars data, hclust betyder vi ordner efter variable der passer sammen</span></a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-24-1.svg" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">corrplot</span>(<span class="kw">cor</span>(mtcars), <span class="dt">order =</span> <span class="st">&quot;hclust&quot;</span>, <span class="dt">tl.col=</span><span class="st">&#39;black&#39;</span>, <span class="dt">tl.cex=</span>.<span class="dv">5</span>) <span class="co">#Her ikke transponeret, hvilket svarer til faktoranalysen vi tidligere så på.</span></a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-24-2.svg" width="672" /></p>
<p>t(mtcars) betyder vi transponerer (vender) matricen, så ser vi i stedet på grupper af respondenter, som vi netop analyserer i klyngeanalysen.</p>
<p>Vi får nu R til at danne klynger vha. af hclust (hierarcical cluster) kommandoen, denne benytter default en metode der hedder complete til at finde ens klynger, der findes mange andre metoder. Algoritmen beregner afstandene mellem de forskellige bilmodeller vha. af den euklidiske metrik. Biler med kort afstand kommer i klynger sammen, biler med lang afstand kommer i forskellige klynger. Neden for ses afstandende mellem hver af de 32 biler, det er en meget stor 32 <span class="math inline">\(\times\)</span> 32 matrice. Fx er afstanden mellem to forskellige biler som en Mazda RX4 og en Lincoln Continental 318.05 hvilket er en stor afstand i forhold til fx. Mazda RX4 og Mazda RX4 Wag på kun 0.62. Bemærk hvordan supersportsvognen Maserati Bora har store afstande til de fleste af de øvrige biler, Maseratien var en komfortabel, rummeligere og kraftigere og tungere sportsvogn end fx. Ferrari Dino.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">head</span>(<span class="kw">as.matrix</span>(<span class="kw">dist</span>(mtcars))) </a></code></pre></div>
<pre><code>##                     Mazda RX4 Mazda RX4 Wag Datsun 710 Hornet 4 Drive
## Mazda RX4           0.0000000     0.6153251   54.90861       98.11252
## Mazda RX4 Wag       0.6153251     0.0000000   54.89152       98.09589
## Datsun 710         54.9086059    54.8915169    0.00000      150.99352
## Hornet 4 Drive     98.1125212    98.0958939  150.99352        0.00000
## Hornet Sportabout 210.3374396   210.3358546  265.08316      121.02976
## Valiant            65.4717710    65.4392224  117.75470       33.55087
##                   Hornet Sportabout   Valiant Duster 360 Merc 240D
## Mazda RX4                  210.3374  65.47177  241.40765  50.15327
## Mazda RX4 Wag              210.3359  65.43922  241.40887  50.11461
## Datsun 710                 265.0832 117.75470  294.47902  49.65848
## Hornet 4 Drive             121.0298  33.55087  169.42996 121.27397
## Hornet Sportabout            0.0000 152.12414   70.17673 241.50697
## Valiant                    152.1241   0.00000  194.60945  89.59111
##                    Merc 230  Merc 280 Merc 280C Merc 450SE Merc 450SL
## Mazda RX4          25.46831  15.36419  15.67247  135.43070  135.40144
## Mazda RX4 Wag      25.32845  15.29569  15.58377  135.42548  135.39604
## Datsun 710         33.18038  66.93635  67.02614  189.19549  189.16317
## Hornet 4 Drive    118.24331  91.42240  91.46129   72.49643   72.43135
## Hornet Sportabout 233.49240 199.33450 199.34066   84.38885   84.36840
## Valiant            85.00796  60.29098  60.26557   90.69703   90.67697
##                   Merc 450SLC Cadillac Fleetwood Lincoln Continental
## Mazda RX4           135.47947           326.3396            318.0470
## Mazda RX4 Wag       135.47232           326.3355            318.0429
## Datsun 710          189.23454           381.0926            372.8012
## Hornet 4 Drive       72.57185           234.4404            227.9726
## Hornet Sportabout    84.43324           116.2804            108.0624
## Valiant              90.70930           266.6281            259.6304
##                   Chrysler Imperial  Fiat 128 Honda Civic Toyota Corolla
## Mazda RX4                 304.72034  93.26800   102.83076       100.6040
## Mazda RX4 Wag             304.71692  93.25310   102.82387       100.5888
## Datsun 710                359.30149  40.99338    52.77046        47.6535
## Hornet 4 Drive            218.15483 184.96897   191.55187       192.6714
## Hornet Sportabout          97.20491 302.03772   310.03246       309.5582
## Valiant                   248.77133 152.11533   158.96158       159.8303
##                   Toyota Corona Dodge Challenger AMC Javelin Camaro Z28
## Mazda RX4              42.30752        163.11508   149.60472  233.22288
## Mazda RX4 Wag          42.26592        163.11342   149.60145  233.22487
## Datsun 710             12.96547        217.77958   204.31889  286.00492
## Hornet 4 Drive        138.53047         72.44039    61.36019  163.66326
## Hornet Sportabout     252.33320         48.98389    61.42742   70.96653
## Valiant               105.28764        103.43107    91.04443  187.84638
##                   Pontiac Firebird Fiat X1-9 Porsche 914-2 Lotus Europa
## Mazda RX4                248.67803  92.50484      44.40337     65.73284
## Mazda RX4 Wag            248.67620  92.49400      44.40736     65.73626
## Datsun 710               303.35839  39.88151      13.13571     25.09486
## Hornet 4 Drive           156.22403 184.44712     139.15795    163.23674
## Hornet Sportabout         40.00525 301.56695     254.14526    272.35824
## Valiant                  188.52721 151.43794     106.05858    130.82482
##                   Ford Pantera L Ferrari Dino Maserati Bora Volvo 142E
## Mazda RX4               245.4247     66.76610      265.6454   39.18940
## Mazda RX4 Wag           245.4294     66.77642      265.6491   39.16260
## Datsun 710              297.2940     90.24155      309.7718   20.69394
## Hornet 4 Drive          180.1140    130.55230      229.3419  137.03633
## Hornet Sportabout        89.5934    215.06739      170.7094  248.00634
## Valiant                 203.0178    106.56948      242.4393  104.18637</code></pre>
<p>Vi kan nu plotte en grafisk oversigt over bilerne. I nederste linje er den fineste inddeling, hvor samtlige biler er i deres egen klynge. Den blå linje med 3 skæringer i dendogrammet indikerer der er 3 klynger, den røde 4 klynger.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1">clusters &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(mtcars))</a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="kw">plot</span>(clusters,<span class="dt">cex=</span><span class="fl">0.5</span>,<span class="dt">main =</span> <span class="st">&quot;Dendogram af mtcars&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;Klyngetræ&quot;</span>,<span class="dt">sub=</span><span class="st">&quot;Bilmodeller&quot;</span>)</a>
<a class="sourceLine" id="cb45-3" data-line-number="3"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">190</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="co">#Tegn rød vandret linje h betyder horisontal</span></a>
<a class="sourceLine" id="cb45-4" data-line-number="4"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">230</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-26-1.svg" width="672" /></p>
<p>Hvis vi ønsker at undersøge en indeling med et bestemt antal klynger, kan vi bruge cutree i R, til at undersøge klyngerne i en skæring med fx. 4 klynger nærmere. Her ser vi som nævnt, Maserati Bora skiller sig ud ved at have sin egen klynge.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">clusterCut &lt;-<span class="st"> </span><span class="kw">cutree</span>(clusters, <span class="dv">4</span>) <span class="co">#Opdeling i 4 klynger.</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2">clusterCut</a></code></pre></div>
<pre><code>##           Mazda RX4       Mazda RX4 Wag          Datsun 710 
##                   1                   1                   1 
##      Hornet 4 Drive   Hornet Sportabout             Valiant 
##                   2                   3                   2 
##          Duster 360           Merc 240D            Merc 230 
##                   3                   1                   1 
##            Merc 280           Merc 280C          Merc 450SE 
##                   1                   1                   2 
##          Merc 450SL         Merc 450SLC  Cadillac Fleetwood 
##                   2                   2                   3 
## Lincoln Continental   Chrysler Imperial            Fiat 128 
##                   3                   3                   1 
##         Honda Civic      Toyota Corolla       Toyota Corona 
##                   1                   1                   1 
##    Dodge Challenger         AMC Javelin          Camaro Z28 
##                   2                   2                   3 
##    Pontiac Firebird           Fiat X1-9       Porsche 914-2 
##                   3                   1                   1 
##        Lotus Europa      Ford Pantera L        Ferrari Dino 
##                   1                   3                   1 
##       Maserati Bora          Volvo 142E 
##                   4                   1</code></pre>
<p>Vi kan benytte subset kommandoen til at se på hvilke variable der er i hver klynge, herunder ser vi på klynge 3.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">subset</span>(clusterCut,clusterCut<span class="op">==</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   Hornet Sportabout          Duster 360  Cadillac Fleetwood 
##                   3                   3                   3 
## Lincoln Continental   Chrysler Imperial          Camaro Z28 
##                   3                   3                   3 
##    Pontiac Firebird      Ford Pantera L 
##                   3                   3</code></pre>
<p>Vi kan ligeledes sammenligne klyngeinddelingen med de enkelte variable og se om disse passer sammen. Fx. passer hp meget fint med inddelingen i klynger.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">table</span>(clusterCut, mtcars<span class="op">$</span>cyl)</a></code></pre></div>
<pre><code>##           
## clusterCut  4  6  8
##          1 11  5  0
##          2  0  2  5
##          3  0  0  8
##          4  0  0  1</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw">table</span>(clusterCut, mtcars<span class="op">$</span>mpg)</a></code></pre></div>
<pre><code>##           
## clusterCut 10.4 13.3 14.3 14.7 15 15.2 15.5 15.8 16.4 17.3 17.8 18.1 18.7
##          1    0    0    0    0  0    0    0    0    0    0    1    0    0
##          2    0    0    0    0  0    2    1    0    1    1    0    1    0
##          3    2    1    1    1  0    0    0    1    0    0    0    0    1
##          4    0    0    0    0  1    0    0    0    0    0    0    0    0
##           
## clusterCut 19.2 19.7 21 21.4 21.5 22.8 24.4 26 27.3 30.4 32.4 33.9
##          1    1    1  2    1    1    2    1  1    1    2    1    1
##          2    0    0  0    1    0    0    0  0    0    0    0    0
##          3    1    0  0    0    0    0    0  0    0    0    0    0
##          4    0    0  0    0    0    0    0  0    0    0    0    0</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">table</span>(clusterCut, mtcars<span class="op">$</span>hp)</a></code></pre></div>
<pre><code>##           
## clusterCut 52 62 65 66 91 93 95 97 105 109 110 113 123 150 175 180 205 215
##          1  1  1  1  2  1  1  1  1   0   1   2   1   2   0   1   0   0   0
##          2  0  0  0  0  0  0  0  0   1   0   1   0   0   2   0   3   0   0
##          3  0  0  0  0  0  0  0  0   0   0   0   0   0   0   2   0   1   1
##          4  0  0  0  0  0  0  0  0   0   0   0   0   0   0   0   0   0   0
##           
## clusterCut 230 245 264 335
##          1   0   0   0   0
##          2   0   0   0   0
##          3   1   2   1   0
##          4   0   0   0   1</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="kw">table</span>(clusterCut, mtcars<span class="op">$</span>carb)</a></code></pre></div>
<pre><code>##           
## clusterCut 1 2 3 4 6 8
##          1 5 6 0 4 1 0
##          2 2 2 3 0 0 0
##          3 0 2 0 6 0 0
##          4 0 0 0 0 0 1</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw">table</span>(clusterCut, mtcars<span class="op">$</span>wt)</a></code></pre></div>
<pre><code>##           
## clusterCut 1.513 1.615 1.835 1.935 2.14 2.2 2.32 2.465 2.62 2.77 2.78
##          1     1     1     1     1    1   1    1     1    1    1    1
##          2     0     0     0     0    0   0    0     0    0    0    0
##          3     0     0     0     0    0   0    0     0    0    0    0
##          4     0     0     0     0    0   0    0     0    0    0    0
##           
## clusterCut 2.875 3.15 3.17 3.19 3.215 3.435 3.44 3.46 3.52 3.57 3.73 3.78
##          1     1    1    0    1     0     0    2    0    0    0    0    0
##          2     0    0    0    0     1     1    0    1    1    0    1    1
##          3     0    0    1    0     0     0    1    0    0    1    0    0
##          4     0    0    0    0     0     0    0    0    0    1    0    0
##           
## clusterCut 3.84 3.845 4.07 5.25 5.345 5.424
##          1    0     0    0    0     0     0
##          2    0     0    1    0     0     0
##          3    1     1    0    1     1     1
##          4    0     0    0    0     0     0</code></pre>
<p>Hvis dendogrammet virker lidt uoverskueligt, kan man vælge ape pakken for at lave mere fancy plots, her er rigtig mange muligheder.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="co">#install.packages(&quot;ape&quot;)</span></a>
<a class="sourceLine" id="cb60-2" data-line-number="2"><span class="kw">library</span>(<span class="st">&quot;ape&quot;</span>)</a>
<a class="sourceLine" id="cb60-3" data-line-number="3">colors =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;pink&quot;</span>)</a>
<a class="sourceLine" id="cb60-4" data-line-number="4">clus4 =<span class="st"> </span><span class="kw">cutree</span>(clusters, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb60-5" data-line-number="5"><span class="kw">plot</span>(<span class="kw">as.phylo</span>(clusters), <span class="dt">type =</span> <span class="st">&quot;fan&quot;</span>, <span class="dt">tip.color =</span> colors[clus4],</a>
<a class="sourceLine" id="cb60-6" data-line-number="6">     <span class="dt">label.offset =</span> <span class="dv">0</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-30-1.svg" width="672" /></p>
<p>Herunder er et plot, hvor farvekoden er baseret på klyngerne.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(hp, mpg)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.4</span>, <span class="dt">size =</span> <span class="fl">3.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">col =</span> clusterCut) </a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-31-1.svg" width="672" /></p>
<p>Vi kunne også have brugt kmeans metoden, her skal vi så angive hvor mange klynger, vi ønsker i analysen. Her benytter vi K-means og får 4 klynger med 12, 9, 7, 4 biler. Vi kan se at når vi sammenligner grupperne med antal cylindre stemmer disse fint overens.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">mtcarsCluster4 &lt;-<span class="st"> </span><span class="kw">kmeans</span>(mtcars, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb62-2" data-line-number="2">mtcarsCluster4</a></code></pre></div>
<pre><code>## K-means clustering with 4 clusters of sizes 16, 7, 4, 5
## 
## Cluster means:
##        mpg      cyl     disp       hp     drat       wt     qsec        vs
## 1 24.50000 4.625000 122.2937  96.8750 4.002500 2.518000 18.54312 0.7500000
## 2 17.01429 7.428571 276.0571 150.7143 2.994286 3.601429 18.11857 0.2857143
## 3 14.60000 8.000000 340.5000 272.2500 3.675000 3.537500 15.08750 0.0000000
## 4 14.68000 8.000000 426.4000 200.0000 3.078000 4.660800 17.45800 0.0000000
##       am  gear     carb
## 1 0.6875 4.125 2.437500
## 2 0.0000 3.000 2.142857
## 3 0.5000 4.000 5.000000
## 4 0.0000 3.000 3.200000
## 
## Clustering vector:
##           Mazda RX4       Mazda RX4 Wag          Datsun 710 
##                   1                   1                   1 
##      Hornet 4 Drive   Hornet Sportabout             Valiant 
##                   2                   4                   2 
##          Duster 360           Merc 240D            Merc 230 
##                   3                   1                   1 
##            Merc 280           Merc 280C          Merc 450SE 
##                   1                   1                   2 
##          Merc 450SL         Merc 450SLC  Cadillac Fleetwood 
##                   2                   2                   4 
## Lincoln Continental   Chrysler Imperial            Fiat 128 
##                   4                   4                   1 
##         Honda Civic      Toyota Corolla       Toyota Corona 
##                   1                   1                   1 
##    Dodge Challenger         AMC Javelin          Camaro Z28 
##                   2                   2                   3 
##    Pontiac Firebird           Fiat X1-9       Porsche 914-2 
##                   4                   1                   1 
##        Lotus Europa      Ford Pantera L        Ferrari Dino 
##                   1                   3                   1 
##       Maserati Bora          Volvo 142E 
##                   3                   1 
## 
## Within cluster sum of squares by cluster:
## [1] 32837.997 11846.095  7654.146 10981.601
##  (between_SS / total_SS =  89.8 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;    
## [5] &quot;tot.withinss&quot; &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;        
## [9] &quot;ifault&quot;</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="kw">table</span>(mtcarsCluster4<span class="op">$</span>cluster, mtcars<span class="op">$</span>cyl)</a></code></pre></div>
<pre><code>##    
##      4  6  8
##   1 11  5  0
##   2  0  2  5
##   3  0  0  4
##   4  0  0  5</code></pre>
<p>Nedenfor ser vi på en inddeling med 3 klynger med henholdsvis 11, 4, 17 biler. Her passer klyngeinddelingen ikke helt så godt med antallet af cylindre.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">mtcarsCluster3 &lt;-<span class="st"> </span><span class="kw">kmeans</span>(mtcars, <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb66-2" data-line-number="2"><span class="kw">table</span>(mtcarsCluster3<span class="op">$</span>cluster, mtcars<span class="op">$</span>cyl)</a></code></pre></div>
<pre><code>##    
##      4  6  8
##   1  0  2  5
##   2  0  0  9
##   3 11  5  0</code></pre>
<!-- # Validering -->
<!-- Skal man undersøge om grupperne er forskellige med hensyn til de forskellige variable, kan man benytte Anova, hvor klyngerne er den uafhængige variabel. Man skal da gerne have at klyngegennemsnittede er signifikant forskellige mht flere af variablene der indgår i analysen.  -->
<!-- Undersøg om der er forskel på hestekræfter hp i de 5 klynger dannet af kmeans analysen hvis du vil gennemføre Anova analysen i Freestat skal du eksportere datasættet.   -->
<!-- Du kan benytte kmeans og export (rio pakken) kommandoerne   -->
<!-- Man kan danne en kvalitativ variabel med fx. 3 klynger med kmeans kommandoen   -->
<!-- Og klistre den på kmeansdatasættet med cbind kommandoen, desværre driller rio pakken på mange windows maskiner. -->
<!-- ```{r} -->
<!-- # install.packages("rio") -->
<!-- library(rio) -->
<!-- mtcarsklynge <- as.data.frame(cbind(kmeans(mtcars,3)$cluster,mtcars$hp)) -->
<!-- export(mtcarsklynge,"mtcarsklynge.xlsx") -->
<!-- ``` -->
<!-- <!-- Der er små forskelle i p-værdierne mellem Freestat og R Anova testet da algoritmerne beregner efter lidt forskellige metoder. -->
<!-- # ```{r} -->
<!-- # anova(lm(mtcarsklynge$V2 ~ mtcarsklynge$V1,data=mtcarsklynge)) -->
<!-- <!-- ``` -->
</div>
            </section>

          </div>
        </div>
      </div>
<a href="faktoranalyse.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="us-arrestationer-samt-urbaniseringsgrad.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
